local util = require 'custom.ui.icons'

return {
  'nvim-lualine/lualine.nvim',

  event = { 'BufReadPre', 'BufNewFile' },
  dependencies = {
    { 'echasnovski/mini.icons', opts = {} },
    { 'linrongbin16/lsp-progress.nvim', opts = {} },
  },
  config = function()
    vim.opt.cmdheight = 0

    require('lualine').setup {
      options = {
        icons_enabled = true,
        theme = 'auto',
        component_separators = { left = '', right = '' },
        section_separators = { left = '', right = '' },
        disabled_filetypes = {
          statusline = {},
          winbar = {},
        },
        ignore_focus = {},
        always_divide_middle = true,
        globalstatus = false,
        refresh = {
          statusline = 1000,
          tabline = 1000,
          winbar = 1000,
        },
      },
      sections = {
        lualine_a = { 'mode' },
        lualine_b = {
          {
            'branch',
            icon = '󰘬 ',
            function(self)
              if self.has_changes then
                return '󰘬 ' .. self.status_dict.head .. '*'
              else
                return '󰘬 ' .. self.status_dict.head
              end
            end,
          },
          'diff',
        },
        lualine_c = {
          {
            'filename',
            symbols = {
              modified = ' ●',
              readonly = ' ',
              unnamed = '',
            },
          },
          {
            'diagnostics',
            symbols = util.icons,
          },
        },
        lualine_x = {
          {
            'datetime',
            style = '%H:%M:%S',
          },
          'fileformat',
          'filetype',
        },
        lualine_y = { 'progress' },
        lualine_z = { 'location' },
      },
      inactive_sections = {
        lualine_a = {},
        lualine_b = {},
        lualine_c = {
          {
            'filename',
            path = 1,
            symbols = {
              modified = ' ●',
              readonly = ' ',
              unnamed = '',
            },
          },
        },
        lualine_x = { 'location' },
        lualine_y = {},
        lualine_z = {},
      },
      tabline = {},
      winbar = {},
      inactive_winbar = {},
      extensions = {},
    }
  end,
}
